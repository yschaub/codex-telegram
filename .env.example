# Codex Telegram Bot Configuration
#
# This bot provides remote access to Codex CLI through Telegram with:
# - Terminal-like interface for Codex commands
# - File upload and archive extraction
# - Git repository integration
# - Quick action buttons for common tasks
# - Session export in multiple formats
# - Image/screenshot analysis
# - Smart follow-up suggestions

# === AUTHENTICATION SETUP ===
# Ensure Codex CLI is installed and logged in on this machine:
# 1. Install Codex CLI
# 2. Login: codex login
# 3. Verify: codex login status

# === REQUIRED SETTINGS ===
# Telegram Bot Token from @BotFather
TELEGRAM_BOT_TOKEN=your_bot_token_here

# Bot username (without @)
TELEGRAM_BOT_USERNAME=your_bot_username

# Base directory for project access (absolute path)
APPROVED_DIRECTORY=/path/to/your/projects

# === SECURITY SETTINGS ===
# Comma-separated list of allowed Telegram user IDs.
# Required in production unless token auth is enabled.
# If empty, only development-mode allow-all fallback can authenticate users.
ALLOWED_USERS=123456789,987654321

# Enable token-based authentication
ENABLE_TOKEN_AUTH=false

# Secret for generating auth tokens (required if ENABLE_TOKEN_AUTH=true)
# Generate with: openssl rand -hex 32
AUTH_TOKEN_SECRET=

# Disable dangerous pattern validation in path/command checks (trusted env only)
# WARNING: enables characters like pipes and redirections in validated input
DISABLE_SECURITY_PATTERNS=false

# Disable tool allowlist/disallowlist validation (trusted env only)
# WARNING: only bypasses tool-name allow/disallow checks; path/command safety checks still run
DISABLE_TOOL_VALIDATION=false

# === CODEX SETTINGS ===
# Path to Codex CLI executable (optional - will auto-detect if not specified)
# Example: /usr/local/bin/codex or ~/.nvm/versions/node/v22/bin/codex
CODEX_CLI_PATH=

# Optional model override (leave blank to use Codex CLI default)
CODEX_MODEL=

# Optional CODEX_HOME override (recommended on locked-down hosts)
# Example: /opt/codex-home
CODEX_HOME=

# Optional extra comma-separated args passed to `codex exec`
# Example: --search,--full-auto
CODEX_EXTRA_ARGS=

# Run Codex in non-interactive full-auto mode (recommended for Telegram bot usage)
CODEX_FULL_AUTO=true

# Maximum conversation turns before requiring new session
CODEX_MAX_TURNS=10

# Timeout for Codex operations (seconds)
CODEX_TIMEOUT_SECONDS=300

# Maximum cost budget per user in USD (Codex cost may not always be available)
CODEX_MAX_COST_PER_USER=10.0

# Allowed tool names (comma-separated list, validation layer)
CODEX_ALLOWED_TOOLS=Read,Write,Edit,Bash,Glob,Grep,LS,Task,TaskOutput,MultiEdit,NotebookRead,NotebookEdit,WebFetch,TodoRead,TodoWrite,WebSearch

# === RATE LIMITING ===
# Number of requests allowed per window
RATE_LIMIT_REQUESTS=10

# Rate limit window in seconds
RATE_LIMIT_WINDOW=60

# Burst capacity for rate limiting
RATE_LIMIT_BURST=20

# === STORAGE SETTINGS ===
# Database URL (SQLite by default)
DATABASE_URL=sqlite:///data/bot.db

# Session timeout in hours
SESSION_TIMEOUT_HOURS=24

# Maximum concurrent sessions per user
MAX_SESSIONS_PER_USER=5

# === FEATURE FLAGS ===
# Enable Model Context Protocol
ENABLE_MCP=false

# Path to MCP configuration file
MCP_CONFIG_PATH=

# Enable Git integration (safe read-only git operations)
ENABLE_GIT_INTEGRATION=true

# Enable file upload handling (including archives)
ENABLE_FILE_UPLOADS=true

# Enable quick action buttons (context-aware actions)
ENABLE_QUICK_ACTIONS=true

# === AGENTIC PLATFORM (OPTIONAL) ===
# Enable FastAPI webhook server
ENABLE_API_SERVER=false
API_SERVER_PORT=8080

# Webhook authentication
GITHUB_WEBHOOK_SECRET=
WEBHOOK_API_SECRET=

# Scheduler and proactive notifications
ENABLE_SCHEDULER=false
NOTIFICATION_CHAT_IDS=

# === PROJECT THREAD MODE ===
# Enable strict routing by Telegram project topics
ENABLE_PROJECT_THREADS=false

# Thread mode:
# - private: topics inside private bot chat (primary)
# - group: forum topics in a supergroup
PROJECT_THREADS_MODE=private

# Target Telegram forum/supergroup chat ID (required only for PROJECT_THREADS_MODE=group)
# Example: -1001234567890
PROJECT_THREADS_CHAT_ID=

# Path to YAML project registry (see config/projects.example.yaml)
PROJECTS_CONFIG_PATH=

# === MONITORING ===
# Log level (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# Enable anonymous telemetry
ENABLE_TELEMETRY=false

# Sentry DSN for error tracking (optional)
SENTRY_DSN=

# === DEVELOPMENT ===
# Environment (development, testing, production)
ENVIRONMENT=production

# Enable debug mode
DEBUG=false

# Enable development features
DEVELOPMENT_MODE=false
